<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Welcome to your interactive web portfolio. I present my major in Data Engineering/Data Science while doing a lot of Java + Web App as hobby projects.">
<meta property="og:title" content="Raflie Zainuddin | A Portfolio">
<!-- <meta property="og:image" content="https://ye-yu.github.io/fast-read/favicon.png"> -->

<!-- CSS only -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

<style media="screen">
  @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Open+Sans&family=Varela+Round&display=swap');

  .color-1 {
    color: #7DBBC3;
  }

  .color-1-bg {
    background-color: #7DBBC3;
  }

  .fill-1 {
    fill: #7DBBC3;
  }

  .color-2 {
    color: #DAEDBD;
  }

  .color-2-bg {
    background-color: #DAEDBD;
  }

  .fill-2 {
    fill: #DAEDBD;
  }

  .color-3 {
    color: #F4B9B2;
  }

  .color-3-bg {
    background-color: #F4B9B2;
  }

  .fill-3 {
    fill: #F4B9B2;
  }

  .color-4 {
    color: #E5B181;
  }

  .color-4-bg {
    background-color: #E5B181;
  }

  .fill-4 {
    fill: #E5B181;
  }

  .color-5 {
    color: #DE6B48;
  }

  .color-5-bg {
    background-color: #DE6B48;
  }

  .fill-5 {
    fill: #DE6B48;
  }

  .leading {
    font-family: 'Bebas Neue', cursive;
  }

  .sub-leading {
    font-family: 'Open Sans', sans-serif;
  }

  .alt-leading {
    font-family: 'Varela Round', sans-serif;
  }

  .mono {
    font-family: 'Source Code Pro', monospace;
  }

  .hover-opacity-50:hover {
    opacity: 50%;
    transition-timing-function: ease-in-out;
    transition-duration: 0.1s;
  }

  .fill-white {
    fill: #FFF;
  }

  .fill-light {
    fill: #F8F9FA;
  }

  .fill-dark {
    fill: #343A40;
  }

</style>
<body>
  <div class="">
    <a class="small px-1" data-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
      > Query my data here
    </a>
    <div class="collapse bg-dark" id="collapseExample">
      <div class="card card-body bg-dark text-white">
        Apps is not active yet!
      </div>
    </div>
  </div>
  <div class="container-fluid">
    <svg class="d-lg-block d-none" width="100%" height="350" id="header-animation">
      <g>
        <circle cx="70%" cy="80%" r="55%" class="fill-dark"></circle>
        <rect x="70%" width="50%" height="100%" fill="#011316"></rect>
        <circle cx="70%" cy="80%" r="48%" fill="#011316"></circle>
      </g>
      <g id="particle-dollar-bin">
      </g>
      <g id="particle-hash-bin">
      </g>
      <g id="particle-amper-bin">
      </g>
      <g id="particle-percent-bin">
      </g>
      <g id="particle-at-bin">
      </g>
      <g id="particle-dollar">
        <rect x="6.5%" y="45" class="fill-white" width="50" height="250"></rect>
        <text y="80" text-anchor="middle">
          <tspan class="h1" x="7%">[</tspan>
          <tspan class="h3" x="8.5%" dy="-3">$</tspan>
          <tspan class="h1" x="10%" dy="3">]</tspan>
        </text>
        <text id="text-dollar-bin" y="80" x="5%" class="h1" text-anchor="end" opacity="0%">NaN</text>
      </g>
      <g id="particle-hash">
        <text y="130" text-anchor="middle">
          <tspan class="h1" x="7%">[</tspan>
          <tspan class="h3" x="8.5%" dy="-3">#</tspan>
          <tspan class="h1" x="10%" dy="3">]</tspan>
        </text>
        <text id="text-hash-bin" y="130" x="5%" class="h1" text-anchor="end" opacity="0%">NaN</text>
      </g>
      <g id="particle-amper">
        <text y="180" text-anchor="middle">
          <tspan class="h1" x="7%">[</tspan>
          <tspan class="h3" x="8.5%" dy="-3">&</tspan>
          <tspan class="h1" x="10%" dy="3">]</tspan>
        </text>
        <text id="text-amper-bin" y="180" x="5%" class="h1" text-anchor="end" opacity="0%">NaN</text>
      </g>
      <g id="particle-percent">
        <text y="230" text-anchor="middle">
          <tspan class="h1" x="7%">[</tspan>
          <tspan class="h3" x="8.5%" dy="-3">%</tspan>
          <tspan class="h1" x="10%" dy="3">]</tspan>
        </text>
        <text id="text-percent-bin" y="230" x="5%" class="h1" text-anchor="end" opacity="0%">NaN</text>
      </g>
      <g id="particle-at">
        <text y="280" text-anchor="middle">
          <tspan class="h1" x="7%">[</tspan>
          <tspan class="h3" x="8.5%" dy="-3">@</tspan>
          <tspan class="h1" x="10%" dy="3">]</tspan>
        </text>
        <text id="text-at-bin" y="280" x="5%" class="h1" text-anchor="end" opacity="0%">NaN</text>
      </g>
      <g>
        <text text-anchor="end" x="96%" y="200" class="leading fill-5 display-2">RAFLIE <tspan class="fill-light">ZAINUDDIN</tspan></text>
        <text text-anchor="end" x="96%" y="240" class="alt-leading h6" fill="#AAA">I enjoy piping and shaping data into</text>
        <text text-anchor="end" x="96%" y="260" class="alt-leading h6" fill="#AAA">a form that benefits you in <tspan class="fill-3 font-weight-bold" text-decoration="underline">productivity</tspan> and <tspan class="fill-3 font-weight-bold" text-decoration="underline">deliveries</tspan>.</text>
      </g>
      <g>
        <rect id="role-box-1" class="fill-2" rx="15" ry="15" height="30"></rect>
        <text id="role-text-1" class="small fill-dark" text-anchor="middle"><tspan class="font-weight-bold">Data</tspan> Science</text>

        <rect id="role-box-2" class="fill-3" rx="15" ry="15" height="30"></rect>
        <text id="role-text-2" class="small fill-dark" text-anchor="middle"><tspan class="font-weight-bold">Data</tspan> Engineering</text>

        <rect id="role-box-3" class="fill-4" rx="15" ry="15" height="30"></rect>
        <text id="role-text-3" class="small fill-dark" text-anchor="middle"><tspan class="font-weight-bold">Web</tspan> Application</text>
      </g>

      <g>
        <rect id="reduce-button-rect" fill="#7DBBC3" rx="18" ry="18" height="35"></rect>
        <text id="reduce-button-text" class="alt-leading h6 fill-white" text-anchor="middle">reduce</text>
        <rect id="reduce-button-front" opacity="0" rx="23" ry="18" height="35"></rect>
      </g>
    </svg>
  </div>
</body>


<!-- JS, Popper.js, and jQuery -->
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>

<!-- d3.js -->
<script src="https://d3js.org/d3.v5.min.js"></script>

<script type="text/javascript">
  "use strict";

  const SVG_WIDTH = $("#header-animation").width();
  const SVG_HEIGHT = 350;

  const ROLE_BOX_ATTR = {
    WIDTH: 180,
    FIXED_Y: 65,
    RIGHT_OFFSET: 0.96,
    SPACING: 20
  }

  const PARTICLE_ATTR = {
    HEIGHT_BOUND: {
      MIN: 0, MAX: SVG_HEIGHT
    },
    LEFT_BOUND: {
      MIN: 0, MAX: SVG_WIDTH * 0.23
    },
    RIGHT_BOUND: {
      MIN: SVG_WIDTH * 0.35, MAX: SVG_WIDTH
    },
    CONTAINER_ID: "g#particle",
    create: (x, y, text, cls) => `<text text-anchor="middle" x="${x}" y="${y}" class="${cls}">${text}</text>`
  }

  function adjustRoleBoxes() {
    const containers = 3;
    for(let i = 1; i <= containers; i++) {
      adjustBoxXPosition(`rect#role-box-${i}`, i);
      adjustBoxTextXPosition(`text#role-text-${i}`, i);
    }
  }

  function adjustReduceButton() {
    const width = 140;
    const y = 310;
    const x = SVG_WIDTH * 0.08;
    const offsetY = 23;

    d3.select("rect#reduce-button-rect").attr('x', x).attr('y', y).attr('width', width);
    d3.select("rect#reduce-button-front").attr('x', x).attr('y', y).attr('width', width)
    .on("mouseover", () => {
      d3.select("rect#reduce-button-rect").transition().duration(200).attr('fill', "#5D9BA3");
    })
    .on("mouseout", () => {
      d3.select("rect#reduce-button-rect").transition().duration(200).attr('fill', "#7DBBC3");
    })
    .on("click", reduceAction);

    d3.select("text#reduce-button-text").attr('x', x + width * 0.5).attr('y', y + offsetY);
  }

  function reduceAction() {
    Object.keys(DIRT_DOMS).forEach(k => {
      const marginTop = 75;
      const spacingY = 50 * DIRT_TYPE.indexOf(k);
      DIRT_DOMS[k].forEach(elem => {
        elem.interrupt();
        elem.transition().duration(randomRange(400, 800))
        .attr('y', marginTop + spacingY)
        .attr('x', SVG_WIDTH * 0.07)
        .on('end', () => {
          elem.remove();
        });
      });
      console.log(`There are ${DIRT_COUNT[k]} of ${k} collected.`);
      d3.select("#text" + DIRT_BIN_MAP[k]).text(DIRT_COUNT[k]).interrupt().attr('opacity', '0%')
      .transition().duration(300).attr('opacity', '100%').delay(800)
      .transition().duration(300).attr('opacity', '0%').delay(2000);
      DIRT_COUNT[k] = 0;
    });
    clearInterval(reduce_int);
    reduce_int = setInterval(reduceAction, 1000 * 60); // clean up display after one minute
  }

  function adjustBoxXPosition(selector, multiplier=1) {
    const roleBox = d3.select(selector);
    const finalX = SVG_WIDTH * ROLE_BOX_ATTR.RIGHT_OFFSET - ROLE_BOX_ATTR.WIDTH * multiplier - ROLE_BOX_ATTR.SPACING * (multiplier - 1);
    roleBox.attr('width', ROLE_BOX_ATTR.WIDTH).attr('x', finalX).attr('y', ROLE_BOX_ATTR.FIXED_Y);
  }

  function adjustBoxTextXPosition(selector, multiplier=1, marginX=20) {
    const roleText = d3.select(selector);
    const finalX = SVG_WIDTH * ROLE_BOX_ATTR.RIGHT_OFFSET - ROLE_BOX_ATTR.WIDTH * multiplier - ROLE_BOX_ATTR.SPACING * (multiplier - 1);
    roleText.attr('x', finalX + ROLE_BOX_ATTR.WIDTH * 0.5).attr('y', ROLE_BOX_ATTR.FIXED_Y + 20);
  }

  function choice(arr) {
    return arr[randomInt(arr.length)];
  }

  const DIRT_TYPE = "$#&%@".split("");
  const DIRT_BIN_MAP = {
    "$": "-dollar-bin",
    "#": "-hash-bin",
    "&": "-amper-bin",
    "%": "-percent-bin",
    "@": "-at-bin"
  }

  const DIRT_COUNT = {
    "$": 0,
    "#": 0,
    "&": 0,
    "%": 0,
    "@": 0
  }

  const DIRT_DOMS = {
    "$": [],
    "#": [],
    "&": [],
    "%": [],
    "@": []
  }

  function spawnDirtParticle() {
    const text = choice(DIRT_TYPE);
    const cls = "fill-white h2";
    const x = randomRange(PARTICLE_ATTR.RIGHT_BOUND.MIN, PARTICLE_ATTR.RIGHT_BOUND.MAX);
    const y = randomRange(PARTICLE_ATTR.HEIGHT_BOUND.MIN, PARTICLE_ATTR.HEIGHT_BOUND.MAX);
    const dirt = d3.select(PARTICLE_ATTR.CONTAINER_ID + DIRT_BIN_MAP[text]).append("text");
    dirt.attr('x', x).attr('y', y).attr('fill', '#011316').text(text);
    dirt.transition().duration(500)
    .attrTween('fill', () => (e) => d3.interpolateRgb("#011316", "#FFF")(d3.easeSinInOut(e)))
    .on('end', () => animateParticle(dirt, x, y));
  }

  function animateParticle(d3Elem, posX, posY) {
    const threshold = PARTICLE_ATTR.RIGHT_BOUND.MIN + 100;
    const timePerX = 5;
    if (posX > threshold) {
      // still on the right side
      const offsetY = 35;
      const randomY = 10 + randomRange(Math.max(PARTICLE_ATTR.HEIGHT_BOUND.MIN, posY - offsetY),  Math.min(PARTICLE_ATTR.HEIGHT_BOUND.MAX - 10, posY + offsetY));
      const randomX = randomRange(30, 200);
      const duration = timePerX * randomX;
      const newX = posX - randomX;
      d3Elem.transition().ease(d3.easeLinear).duration(duration)
      .attr('x', newX)
      .attrTween('y', () => (e) => d3.interpolate(posY, randomY)(d3.easeSinInOut(e)))
      .on('end', () => {
        animateParticle(d3Elem, newX, randomY);
      });
    } else {
      const text = d3Elem.text();
      const count = DIRT_COUNT[text]++;
      DIRT_DOMS[text].push(d3Elem);
      const extraMaxCount = {
        "$": 3,
        "#": 2,
        "&": 1,
        "%": 0,
        "@": 0
      }
      const marginTop = 75;
      const spacingY = 50 * DIRT_TYPE.indexOf(text);
      const marginLeft = SVG_WIDTH * 0.11;
      const spacingX = 12 * (count % (18 + (extraMaxCount[text])));
      d3Elem.transition().ease(d3.easeLinear).duration(800)
      .attrTween('fill', () => (e) => d3.interpolateRgb("#FFF", "#011316")(d3.easeSinInOut(Math.min(e * 2, 1))))
      .attr('x', posX - 50)
      .attrTween('y', () => (e) => d3.interpolate(posY, marginTop + spacingY)(d3.easeSinInOut(e)))
      .transition().ease(d3.easeLinear).duration(1200)
      .attr('x', marginLeft + spacingX);
    }
  }

  function randomInt(max) {
    return Math.floor(Math.random() * Math.floor(max));
  }

  function randomRange(min, max) {
    return Math.random() * (max - min) + min;
  }

  let reduce_int;
  if (SVG_WIDTH >= 992){
    adjustRoleBoxes();
    adjustReduceButton();
    setInterval(() => {
      let r = randomInt(5);
      for (let i = 0; i < r; i++) spawnDirtParticle();
    }, randomRange(200, 800));
    reduce_int = setInterval(reduceAction, 1000 * 60); // clean up display after one minute
  } else {
    console.info("Small screen display. Not rendering animation.");
  }
</script>
